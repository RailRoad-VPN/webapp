"use strict";$(document).ready(function(){var m=$("meta#change_status_user_device_block_text").data("text");var a=$("meta#email_saved_text").data("text");var J=$("meta#password_saved_text").data("text");var u=$("meta#get_pincode_url");var y=$("meta#renew_sub_url");var D=$("meta#get_order_payment_url");var q=$("meta#delete_user_device_url");var i=$("meta#change_status_user_device_url");var t=$("meta#delete_account_url");var w=$("meta#is_pin_code_activated_url");var z=$("meta#update_email_url");var p=$("meta#update_password_url");var K=$("meta#email_check_url");var F,s,b;var c=$("#profile-menu");var A=c.find("li");var f=A.find("a");var C=$(".generate-pin-btn");var h=$(".is_user_has_active_subscribe").length>0;if(!h){C.addClass("disabled");C.attr("data-toggle","tooltip");$('[data-toggle="tooltip"]').tooltip()}$('a[data-toggle="tab"]').on("shown.bs.tab",function(M){console.log("tab shown...")});var x=$("#account-email-input");var e=$("#account-password-input");var n=$("#delete-account-email-input");var r=$("#vpn_servers-table").DataTable({paging:false,searching:true,language:{url:$("#data_table_lang_url").data("url")}});c.append("<li id='magic-line'></li>");var L=$("#magic-line");B(A.first());f.hover(function(){F=$(this);s=F.position().left;b=F.parent().width();L.stop().animate({left:s,width:b})},function(){L.stop().animate({left:L.data("origLeft"),width:L.data("origWidth")})});f.on("click",function(M){B($(this).parent())});function B(M){L.width(M.width()).css("left",M.find("a").position().left).data("origLeft",L.position().left).data("origWidth",L.width())}C.click(function(){if(!h){return false}var O=true;var M=function(P){if(P.hasOwnProperty("success")&&P.success){if(P.hasOwnProperty("data")){$("#pincode-t").text(P.data["pin_code"]);$("#cd_seconds").val(P.data["seconds"]);$.APP.startTimer("cd");unblockPage(function(){$("#pincode-modal").modal("show")})}}else{showErrors(P);unblockPage()}};var N=function(P){notyError("System Error");unblockPage()};blockPage(function(){doAjax(u.data("url"),u.data("method"),{},O,M,N)})});var I;$("#pincode-modal").on("shown.bs.modal",function(){I=setInterval(function(){var O=true;var M=function(P){if(P.success){if(P.hasOwnProperty("data")&&P.data.hasOwnProperty("is_pin_code_activated")){if(P.data["is_pin_code_activated"]){alert("pin code activated")}}}};var N=function(P){notyError("System Error")};doAjax(w.data("url"),w.data("method"),{},O,M,N)},5000)});$("#pincode-modal").on("hide.bs.modal",function(){clearInterval(I)});$(".renew-sub-btn").click(function(){var P=true;var O={sub_id:$(this).data("sub_id"),order_code:$(this).data("order_code"),subscription_uuid:$(this).data("subscription_uuid")};var M=function(Q){if(Q.success){window.location=Q.data["redirect_url"]}else{if(Q.hasOwnProperty("errors")){showErrors(Q)}}};var N=function(Q){notyError("System Error")};doAjax(y.data("url"),y.data("method"),JSON.stringify(O),P,M,N)});var o={};$(".payment-wait").each(function(){var M=$(this).data("order_code");o[M]=setInterval(function(){j(M)},5000)});$(".change-status-device-btn").click(function(){var M=$(this).data("uuid");var N=$(this).data("is_active");var O;if(N===1){O=0}else{O=1}k(M,O)});$(".delete-device-btn").click(function(){var M=$(this).data("uuid");g(M)});x.on("focusout keyup keypress blur change",function(){v()});$("#save-email-btn").click(function(){if(x.hasClass("is-invalid")){markInput(x,false);return false}blockElement(null,$("#save-email-btn"),function(){d(x.val())})});$("#save-password-btn").click(function(){if(x.hasClass("is-invalid")){markInput(x,false);return false}var M=e.val();if(!G()){return false}l(M)});$("#account-delete-btn").click(function(){var O=$.trim(n.val());if(n.data("current_email")!==O){markInput(n,false);n.parent().find(".correct_error").show();return false}n.parent().find(".error").hide();markInput(n,true);var Q={email:O};var P=true;var M=function(R){if(R.hasOwnProperty("success")&&!R.success){n.parent().find(".correct_error").show();markInput(n,false)}else{if(R.hasOwnProperty("next")){window.location=R.next}}};var N=function(R){notyError("System Error")};doAjax(t.data("url"),t.data("method"),JSON.stringify(Q),P,M,N)});function j(P){var O=true;var M=function(S){if(S.hasOwnProperty("success")&&S.success){if(S.hasOwnProperty("data")){var U=S.data;if(U.hasOwnProperty("order")){var Q=U.order;var R=Q.is_success;var T=Q.code;if(R===true){clearInterval(o[T]);window.location.reload()}}}}else{showErrors(S)}};var N=function(Q){notyError("System Error")};doAjax(D.data("url").replace(-1,P),D.data("method"),{},O,M,N)}function k(O,T){var S=$('.user-device[data-uuid="'+O+'"]');var R=S.find(".change-status-device-btn");var Q=true;var P={device_uuid:O,status:T===1};var M=function(U){if(U.hasOwnProperty("success")&&U.success){var V=S.find(".badge-status");var W;var X;if(T===1){V.removeClass("badge-warning").addClass("badge-success");X=V.data("active_text");W=R.data("deactivate_text")}else{V.removeClass("badge-success").addClass("badge-warning");X=V.data("inactive_text");W=R.data("activate_text")}R.text(W);V.text(X);R.data("is_active",T);unblockElement(S)}else{showErrors(U)}};var N=function(U){notyError("System Error")};blockElement(m,S,function(){doAjax(i.data("url"),i.data("method"),JSON.stringify(P),Q,M,N)})}function g(O){var Q=true;var P={device_uuid:O};var M=function(R){if(R.hasOwnProperty("success")&&R.success){$('.user-device[data-uuid="'+O+'"]').remove()}else{showErrors(R)}};var N=function(R){notyError("System Error")};doAjax(q.data("url"),q.data("method"),JSON.stringify(P),Q,M,N)}function l(O){if(O===""){markInput(e,false);e.parent().find(".empty_error").show();return false}var Q=true;var P={password:O};var M=function(R){if(R.hasOwnProperty("success")&&R.success){notySuccess(J);unblockElement($("#save-password-btn"))}else{showErrors(R)}};var N=function(R){notyError("System Error")};blockElement(null,$("#save-password-btn"),function(){doAjax(p.data("url"),p.data("method"),JSON.stringify(P),Q,M,N)})}function d(O){if(O===""){markInput(x,false);x.parent().find(".empty_error").show();unblockElement($("#save-email-btn"));return false}if(x.data("current_email")===O){unblockElement($("#save-email-btn"));x.parent().find(".same_warning").show();return false}var Q=true;var P={email:O};var M=function(R){if(R.hasOwnProperty("success")&&R.success){notySuccess(a);x.data("current_email",O);n.data("current_email",O)}else{showErrors(R)}unblockElement($("#save-email-btn"))};var N=function(R){notyError("System Error")};doAjax(z.data("url"),z.data("method"),JSON.stringify(P),Q,M,N)}function v(){var R;var O=$.trim(x.val());if(O===""){markInput(x,false);x.parent().find(".empty_error").show();R=true;return false}else{if(O.indexOf("@")===-1){markInput(x,false);x.parent().find(".empty_error").show();R=true;return false}else{R=false}}if(x.data("current_email")===O){return false}var Q={email:O};var P=true;var M=function(S){if(S.hasOwnProperty("success")&&!S.success){x.parent().find(".busy_error").show();markInput(x,false)}else{x.parent().find(".error").hide();if(R===false){markInput(x,true)}}};var N=function(S){notyError("System Error")};doAjax(K.data("url"),K.data("method"),Q,P,M,N)}function G(){var N=$.trim(e.val());var M=e.parent();if(N===""){M.find(".empty_error").show();markInput(e,false);return false}else{if(N.length<6){M.find(".short_error").show();markInput(e,false);return false}else{M.find(".short_error").hide();markInput(e,true);return true}}}setTimeout(function(){$("#vpn_servers-table_filter").hide()},500);$("#vpn_servers-search-input").keyup(function(){r.search($(this).val()).draw()});var H=document.location.hash;var E="tab_";if(H.indexOf(E)>-1){$('.nav-tabs a[href="'+H+'"]').click()}$(".nav-tabs a").click(function(N){$(this).tab("show");var M=$("body").scrollTop();window.location.hash=this.hash;$("html,body").scrollTop(M)})});